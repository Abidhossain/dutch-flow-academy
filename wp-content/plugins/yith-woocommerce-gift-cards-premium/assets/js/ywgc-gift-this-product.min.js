!function(u){var y;"undefined"!=typeof ywgc_data&&(y=u("#give-as-present"),u(document).on("yith_ywgc_gift_this_product_modal_template_loaded",function(e,t){var a=y.attr("data-price"),c=y.attr("data-price-html"),i=y.data("product-id"),r=y.data("product-name"),d=y.data("image-url"),g=u(".ywgc-gift-card-shipping-total-value").data("shipping-cost");function o(e,t){u("span.ywgc-gift-card-shipping-total-value").text(e.replace(".",ywgc_data.currency_format_decimal_sep)+" "+ywgc_data.currency_format_symbol),u("span.ywgc-gift-card-product-total-value").text(t+" "+ywgc_data.currency_format_symbol);e=parseFloat(e)+parseFloat(t);"left"==ywgc_data.currency_position?u("span.ywgc-gift-card-total-value").text(ywgc_data.currency_format_symbol+e.toFixed(2).toString().replace(".",ywgc_data.currency_format_decimal_sep)):"right"==ywgc_data.currency_position?u("span.ywgc-gift-card-total-value").text(e.toFixed(2).toString().replace(".",ywgc_data.currency_format_decimal_sep)+ywgc_data.currency_format_symbol):"right_space"==ywgc_data.currency_position?u("span.ywgc-gift-card-total-value").text(e.toFixed(2).toString().replace(".",ywgc_data.currency_format_decimal_sep)+" "+ywgc_data.currency_format_symbol):u("span.ywgc-gift-card-total-value").text(ywgc_data.currency_format_symbol+" "+e.toFixed(2).toString().replace(".",ywgc_data.currency_format_decimal_sep)),u("input.ywgc-gift-this-product-total-value").val(e)}u("form.gift-cards_form").append('<input type="hidden" class="ywgc-as-present" name="ywgc-as-present" value="yes">'),u("form.gift-cards_form").append('<input type="hidden" class="ywgc-gifted-product-id" name="ywgc-gifted-product-id" value="'+i+'">'),u("form.gift-cards_form").append('<input type="hidden" class="ywgc-manual-amount" name="ywgc-manual-amount" value="'+a+'">'),u(".ywgc-form-preview-amount").html(c),u(".ywgc-product-price").html(c),u(".ywgc-product-title").html(r),u(".ywgc-product-image").attr("src",d),u("head").find("link#ywgc-product-layout-1-css").remove(),"yes"===ywgc_data.shipping_in_gift_this_product&&((g=ywgc_data.fixed_shipping_value).toString().replace('"',""),o(g,a)),u("input#ywgc-include-shipping-checkbox").on("click",function(){"no"===ywgc_data.fixed_shipping?u("input#ywgc-include-shipping-checkbox").prop("checked")?(u("div.ywgc-country-select-main-container ").removeClass("ywgc-hidden"),u("button.ywgc-add-gift-product-to-cart").css("margin","8em 0 0 auto")):(u("div.ywgc-country-select-main-container ").addClass("ywgc-hidden"),u("button.ywgc-add-gift-product-to-cart").css("margin","3em auto 0 auto")):u("input#ywgc-include-shipping-checkbox").prop("checked")?(u("div.ywgc-include-fixed-shipping-container ").removeClass("ywgc-hidden"),u("button.ywgc-add-gift-product-to-cart").css("margin","8em 0 0 auto")):u("div.ywgc-include-fixed-shipping-container ").addClass("ywgc-hidden")}),u("#ywgc-country-select").on("change",function(){var t=u(".ywgc-gift-this-product-totals"),e={country_code:u(this).val(),postal_code:u("#ywgc-postal-code-input").val(),action:"ywgc_get_shipping_for_gift_this_product"};t.block({message:null,overlayCSS:{background:"#f1f1f1",opacity:.5}}),u.ajax({type:"POST",url:ywgc_data.ajax_url,data:e,dataType:"html",success:function(e){e=e.replace('"',"");o(parseFloat(e,10).toString(),a),t.unblock()},error:function(e){return console.log("ERROR"),console.log(e),t.unblock(),!1}})}),u("#ywgc-postal-code-input").on("input",function(){u("#ywgc-country-select").change()});var s=u(".ywgc-recipient-name input"),n=(s.on("change keyup",function(e){e.preventDefault();e=s.val(),e=u.parseHTML(e.replace(/(<([^>]+)>)/gi,""));u(".ywgc-form-preview-to-content").html(e)}),u(".ywgc-sender-name input")),l=(n.on("change keyup",function(e){e.preventDefault();e=n.val(),e=u.parseHTML(e.replace(/(<([^>]+)>)/gi,""));u(".ywgc-form-preview-from-content").html(e)}),u(".ywgc-message textarea")),p=(l.on("change keyup",function(e){e.preventDefault();e=l.val(),e=u.parseHTML(e.replace(/(<([^>]+)>)/gi,"").replace(/\n/g,"<br/>"));u(".ywgc-form-preview-message").html(e)}),u(function(){u("#ywgc-delivery-date").datetimepicker({minDate:ywgc_data.min_date,maxDate:ywgc_data.max_date,dateFormat:ywgc_data.date_format,timeFormat:ywgc_data.time_format,timezone:ywgc_data.timezone,showSecond:!1,showMillisec:!1,showMicrosec:!1,showTimezone:!1,hourText:ywgc_data.hour_text,currentText:ywgc_data.current_text,closeText:ywgc_data.close_text,controlType:"select",beforeShow:function(e,t){u("#ui-datepicker-div").addClass("ywgc-date-picker"),setTimeout(function(){u("#ywgc-delivery-date").datepicker("widget").find(".ui-timepicker-div").hide(),u(".ui-datepicker-calendar td").hasClass("ui-datepicker-current-day")?u("#ywgc-delivery-date").datepicker("widget").find(".ui-timepicker-div").show():u(ywgc_data.today_selected_message_div).insertAfter(".ui-timepicker-div"),u(".yith-ywgc-gift-this-product-modal-wrapper").css("overflow","hidden"),e.dpDiv.css({top:u(".datepicker").offset().top,left:u(".datepicker").offset().left})},1)},onSelect:function(e,t){setTimeout(function(){u("td.ui-datepicker-today").hasClass("ui-datepicker-current-day")?(u("#ywgc-delivery-date").datepicker("widget").find(".ui-timepicker-div").hide(),u(ywgc_data.today_selected_message_div).insertAfter(".ui-timepicker-div"),u("input#ywgc-delivery-date").val("")):u("#ywgc-delivery-date").datepicker("widget").find(".ui-timepicker-div").show()},1)},onClose:function(e,t){u(".yith-ywgc-gift-this-product-modal-wrapper").css("overflow","auto")}})}),u(".product-type-gift-card .woocommerce-product-gallery__image a")),m=u(".product-type-gift-card .woocommerce-product-gallery__image--placeholder");u(".ywgc-preset-image.ywgc-default-product-image img").addClass("selected_design_image"),u(t).on("click",".product-type-gift-card form.gift-cards_form.cart .ywgc-preset-image img:not(.ywgc_upload_plus_icon)",function(e){e.preventDefault();var t,a,e=u(this).closest(".ywgc-preset-image").data("design-id");u(document).trigger("ywgc-picture-changed",["template",e]),u("a.lightbox-added").remove(),0!=u(".product-type-gift-card .woocommerce-product-gallery__wrapper").children().length&&(u(".product-type-gift-card .woocommerce-product-gallery__image").remove(),e=u(this).closest(".ywgc-preset-image").data("design-url"),t=u(this).attr("srcset"),a=u(this).attr("src"),(u(this).hasClass("custom-selected-image")||u(this).hasClass("custom-modal-selected-image"))&&(e=a),0!=m.length&&m.remove(),u('<div data-thumb="'+a+'" data-thumb-alt class="woocommerce-product-gallery__image"><a href="'+e+'"><img src="'+e+'" class="wp-post-image size-full" alt="" data-caption="" data-src="'+e+'" data-large_image="'+e+'" data-large_image_width="1024" data-large_image_height="1024" sizes="(max-width: 600px) 100vw, 600px"'+t+' width="600" height="600"></a></div>').insertBefore(".ywgc-main-form-preview-container"))}),u(t).on("click",".ywgc-preset-image img:not(.ywgc_upload_plus_icon)",function(e){e.preventDefault();e=u(this).closest(".ywgc-preset-image").data("design-id");u(".ywgc-preset-image img").removeClass("selected_design_image"),u(".ywgc-preset-image").removeClass("selected_image_parent"),u(this).addClass("selected_design_image"),u(this).closest(".ywgc-preset-image").addClass("selected_image_parent"),u(document).trigger("ywgc-picture-changed",["template",e])}),u("#ywgc-upload-picture").on("change",function(){u(".ywgc-preset-image img").removeClass("selected_design_image");u(".ywgc-picture-error").remove();var e,t=u(this).val().split(".").pop().toLowerCase();-1==u.inArray(t,["png","jpg","jpeg"])?u("div.gift-card-content-editor.step-appearance").append('<span class="ywgc-picture-error">'+ywgc_data.invalid_image_extension+"</span>"):u(this)[0].files[0].size>1024*ywgc_data.custom_image_max_size*1024&&0<ywgc_data.custom_image_max_size?u("div.gift-card-content-editor.step-appearance").append('<span class="ywgc-picture-error">'+ywgc_data.invalid_image_size+"</span>"):(t=u(this)[0].files[0],(e=new FileReader).readAsDataURL(t),e.onload=function(e){var e=e.target.result,t='<img src="'+e+'" class="attachment-thumbnail size-thumbnail  custom-selected-image selected_design_image" alt="" srcset="'+e+" 150w, "+e+" 250w, "+e+' 100w" sizes="(max-width: 150px) 85vw, 150px" width="150" height="150">',a='<img src="'+e+'" class="wp-post-image size-full" alt="" width="600" height="600">';u(".ywgc-design-list li.default-image-li .ywgc-preset-image ").hasClass("ywgc-default-product-image")?(u(".ywgc-design-list li.default-image-li .ywgc-preset-image").html(t),p.html(a)):u(".ywgc-design-list li.default-image-li .ywgc-preset-image").html(t),u(".ywgc-design-list .ywgc-preset-image img.custom-selected-image").parent().attr("data-design-url",e),u(".ywgc-design-list .ywgc-preset-image img.custom-selected-image").parent().attr("data-design-id","custom"),u(".custom-selected-image ").click(),u(".yith-plugin-fw-file.yith-ywgc-upload-file-field").removeClass("yith-plugin-fw--is-dragging"),u(document).trigger("ywgc-picture-changed",["custom","custom"])})})}))}(jQuery);