(()=>{"use strict";var e={r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function a(e){var t=function(e,t){if("object"!==o(e)||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var i=a.call(e,t||"default");if("object"!==o(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===o(t)?t:String(t)}function i(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,a(i.key),i)}}function n(e,t,o){return(t=a(t))in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}e.r(t);const s={xhr:!1,block:function(e){e&&e.length&&void 0!==jQuery.fn.block&&(e.addClass("ajax-blocked"),e.block({message:null,overlayCSS:{background:"#fff no-repeat center",opacity:.5,cursor:"none"}}))},unblock:function(e){e&&e.hasClass("ajax-blocked")&&void 0!==jQuery.fn.block&&(e.unblock(),e.removeClass("ajax-blocked"))},call:function(e,t,o){var a=this;return o=void 0!==o?o:"GET",Array.isArray(e)?(e.push({name:"action",value:yith_wcmv_ajax.ajaxAction}),e.push({name:"security",value:yith_wcmv_ajax.ajaxNonce}),e.push({name:"context",value:"admin"})):(e.action=yith_wcmv_ajax.ajaxAction,e.security=yith_wcmv_ajax.ajaxNonce,e.context="admin"),a.block(t),a.xhr=jQuery.ajax({url:yith_wcmv_ajax.ajaxUrl,data:e,type:o}).fail((function(e){console.log(e),a.unblock(t)})).done((function(e){a.unblock(t),a.xhr=!1})),a.xhr},get:function(e,t){return this.call(e,t,"GET")},post:function(e,t){return this.call(e,t,"POST")},abort:function(){this.xhr&&this.xhr.abort()}};new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),n(this,"modal",void 0),n(this,"templateHeader",void 0),n(this,"templateContent",void 0),n(this,"templateFooter",void 0),n(this,"statusChanged",void 0),this.templateHeader=wp.template("yith-wcmv-modal-commission-header"),this.templateContent=wp.template("yith-wcmv-modal-commission-content"),this.templateFooter=wp.template("yith-wcmv-modal-commission-footer"),this.init()}var t,o,a;return t=e,(o=[{key:"init",value:function(){jQuery(document).on("click",".commission-details:not(.disabled)",{self:this},this.view),jQuery(document).on("change",".commission-details-modal #commission-status",this.statusChange.bind(this)),jQuery(document).on("click",".commission-details-modal .save-commission",{self:this},this.save),jQuery(document).on("change",".enable-gateway-trigger .on_off",this.enableGateway),jQuery(document).on("submit","form.gateway-options-form",this.gatewayFormSubmit),jQuery(document).on("click",".list-item.has-options .name > *",this.gatewaySlide)}},{key:"openModal",value:function(e){return void 0===this.templateHeader||void 0===this.templateContent||void 0===this.templateFooter?(console.error("Error loading commissions templates"),!1):void 0!==e&&void(this.modal=yith.ui.modal({title:this.templateHeader(e),content:this.templateContent(e),footer:this.templateFooter(e),classes:{wrap:"commission-details-modal"}}))}},{key:"view",value:function(e){e.preventDefault();var t=e.data.self,o=jQuery(this),a=o.data("commission_id"),i=o.data("commission-data");return void 0===i?(o.addClass("disabled"),s.abort(),s.call({request:"commission_details",commission_id:a},jQuery(this).closest("td")).done((function(e){o.removeClass("disabled"),e.success&&(o.data("commission-data",e.data),t.openModal(e.data))}))):t.openModal(i),!1}},{key:"statusChange",value:function(){this.statusChanged=!0}},{key:"save",value:function(e){e.preventDefault();var t=e.data.self;if(!0===t.statusChanged){var o=jQuery('[name="commission-status"]').val(),a=jQuery(this).attr("data-commission_id");s.post({request:"commission_change_status",commission_id:a,status:o},jQuery(".commission-details-modal .yith-plugin-fw__modal__main")).done((function(e){window.location.reload()}))}else t.modal.close()}},{key:"enableGateway",value:function(e){e.preventDefault();var t=jQuery(this),o=t.is(":checked");return t.attr("disabled","disabled"),s.call({request:"switch_gateway_enabled",gateway_id:t.data("gateway_id"),gateway_enabled:o?"yes":"no"},t.closest(".list-item")).done((function(e){t.removeAttr("disabled"),e.success||t.prop("checked",!o)})),!1}},{key:"gatewayFormSubmit",value:function(e){e.preventDefault();var t=jQuery(this).serializeArray();return t.push({name:"request",value:"save_gateway_options"}),s.call(t,jQuery(this).closest(".list-item"),"POST"),!1}},{key:"gatewaySlide",value:function(e){var t=jQuery(this).closest(".list-item");t.toggleClass("opened"),t.find(".options").slideToggle()}}])&&i(t.prototype,o),a&&i(t,a),Object.defineProperty(t,"prototype",{writable:!1}),e}());var r=window;for(var l in t)r[l]=t[l];t.__esModule&&Object.defineProperty(r,"__esModule",{value:!0})})();